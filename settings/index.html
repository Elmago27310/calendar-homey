<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="style.css" />

        <!-- Homey settings -->
        <script type="text/javascript" src="/homey.js" data-origin="settings"></script>
        <!-- Variable management (browserify) -->
        <script type="text/javascript" src="variable-management.js"></script>
      </head>
      
      <body>

        <h1 data-i18n="settings.title">
            <!--
                This field will automatically be filled by a translated string with key 'settings.title'.
                Read more about translations at Internationalization.
        	-->
        </h1>

        <div id="calendars">
            <fieldset class="clonable">
                <legend data-i18n="settings.calendars.legend"></legend>

                <strong data-i18n="settings.calendars.name"></strong><br>
                <input id="uri-name" type="text" value="" /><br><br>

                <strong data-i18n="settings.calendars.uri"></strong><br>
                <input id="uri-uri" type="text" value="" />
            </fieldset>
        </div>

        <div class="full-width">
            <p>
                <button id="newItem" class="right" data-i18n="settings.buttons.new_item"></button>
            </p>
        </div>

        <div class="datetime">
            <fieldset>
                <legend data-i18n="settings.datetime.legend"></legend>

                <p data-i18n="settings.datetime.date.description"></p>
                <strong data-i18n="settings.datetime.date.name"></strong><br>
                <input id="datetime-date" type="text" value="" minlength="6" maxlength="18" style="text-transform:uppercase" pattern="[d \-./:]{0,7}([DM]{1,2}[/.-]{1,1}[DM]{1,2}[/.-]{1,1}[Y]{2,4})|([Y]{2,4}[/.-]{1,1}[DM]{1,2}[/.-]{1,1}[DM]{1,2})" /><br><br>

                <p data-i18n="settings.datetime.time.description"></p>
                <strong data-i18n="settings.datetime.time.name"></strong><br>
                <input id="datetime-time" type="text" value="" minlength="3" maxlength="5" pattern="[Hh]{1,2}[:.][m]{1,2}" />
            </fieldset>
        </div>

        <div class="eventlimit">
            <fieldset>
                <legend data-i18n="settings.eventlimit.legend"></legend>

                <p data-i18n="settings.eventlimit.description"></p>

                <strong data-i18n="settings.eventlimit.value"></strong>
                <input id="eventlimit-value" type="number" value="" min="1" /><br><br>

                <strong data-i18n="settings.eventlimit.type"></strong>
                <select id="eventlimit-type"></select>
            </fieldset>
        </div>

        <div class="misc">
            <fieldset>
                <legend data-i18n="settings.misc.legend"></legend>

                <div class="nextEventTokensPerCalendar settings-section">
                    <strong data-i18n="settings.misc.nextEventTokensPerCalendar"></strong><br><br>
                    <input id="misc-nextEventTokensPerCalendar" type="checkbox" />
                </div>

                <div class="nextEventTokensWithText settings-section">
                    <strong data-i18n="settings.misc.nextEventTokensWithText.title"></strong><br>
                    <p data-i18n="settings.misc.nextEventTokensWithText.description"></p>
                    <input id="misc-nextEventTokensWithText" type="checkbox" /><br><br>
                    <input id="misc-nextEventTokensWithText-type-summary" type="radio" name="nextEventTokensWithText-type" /><span data-i18n="settings.misc.nextEventTokensWithText.type.summary" class="next-event-token-with-text-type"></span>
                    <input id="misc-nextEventTokensWithText-type-location" type="radio" name="nextEventTokensWithText-type" /><span data-i18n="settings.misc.nextEventTokensWithText.type.location" class="next-event-token-with-text-type"></span>
                    <input id="misc-nextEventTokensWithText-type-description" type="radio" name="nextEventTokensWithText-type" /><span data-i18n="settings.misc.nextEventTokensWithText.type.description" class="next-event-token-with-text-type"></span><br><br>
                    <select id="misc-nextEventTokensWithText-calendar">
                        <option value="no_icalcalendar_chosen" data-i18n="settings.misc.nextEventTokensWithText.chooseCalendar"></option>
                    </select><br><br>
                    <span data-i18n="settings.misc.nextEventTokensWithText.text"></span><br>
                    <input id="misc-nextEventTokensWithText-text" type="text" value="" />
                </div>
            </fieldset>
        </div>

        <button id="save" class="right" data-i18n="settings.buttons.save"></button>

        <div id="uri_error" class="uri-error-hidden"></div>

        <p class="icons-info"><span data-i18n="settings.icons_info"></span> <a href="https://icons8.com/">Icons8</a></p>
        
        <script src="icalcalendar.js" type="text/javascript"></script>

        <script type="text/javascript">
            const nextEventTokensWithText = document.getElementById('misc-nextEventTokensWithText')
            const nextEventTokensPerCalendar = document.getElementById('misc-nextEventTokensPerCalendar')
            const toggleActive = element => {
                if (element.checked) {
                    element.parentElement.classList.add('active')
                } else {
                    element.parentElement.classList.remove('active')
                }
            }

            toggleActive(nextEventTokensWithText)
            toggleActive(nextEventTokensPerCalendar)
            nextEventTokensWithText.addEventListener('change', () => toggleActive(nextEventTokensWithText))
            nextEventTokensPerCalendar.addEventListener('change', () => toggleActive(nextEventTokensPerCalendar))
        </script>

      </body>
</html>
